About this file

This file contains the source of the embedded diagram for
ARCHITECTURE.md. It is an ASCII diagram, in a format
that is understood by Ditaa (https://ditaa.sourceforge.net/).
A PNG version of it, generated by Ditaa, is embedded in
network-security.md.

If you are using emacs, you can use org mode to generate the PNG
version of the diagram automatically. See
https://orgmode.org/worg/org-contrib/babel/languages/ob-doc-ditaa.html.

You can also run 'ditaa' directly:

```
awk '/#\+BEGIN_SRC/{flag=1;next}/#\+END_SRC/{flag=0}flag' ARCHITECTURE-network-diagram.org | ditaa /dev/stdin ARCHITECTURE-network-diagram.png
```


#+BEGIN_SRC ditaa :file ARCHITECTURE-network-diagram.png

        +-------------------+     +------------+    +-------------------+
        |                   |     |            |    |                   |
        | neonvm controller |---->* Kubernetes *<---|     Scheduler     |
        |                   *<----| API server |    |   (with plugin)   |
        |                   |     |            |    |                   |
        +-------------------+     +------*-----+    +--------*----------+
                  |                      ^                   ^ plugin/agent protocol
                  |                      |                   | 10299
                  |                      |         +--------------------+
                  |                      |         |                    |
                  |                      +---------|  autoscaler agent  |
                  |                                |                    |
                  |                                | (one per K8s node) |
                  |                                +-----------------*--+
                  |                                  |           |   ^ random port
                  |                                  |           |   |  (per VM)
                  |                                  |           |   |
+=================|==================================|===========|===|======+
: K8s pod         |                                  |           |   |      :
:             QMP |                                  |           |   |      :
:           20183 V                                  |           |   |      :
: +---------------*----------------------------------|-----------|---|---+  :
: |                                                  |           |   |   |  :
: | QEMU process                                     |           |   |   |  :
: |                                                  |           |   |   |  :
: |                                                  |           |   |   |  :
: |            compute_ctl    postgres       metrics | informant |   |   |  :
: |               mgmt API    postgres    prometheus | informant |   |   |  :
: |                   3080        5432          9100 V     10301 V   |   |  :
: +------------------------*-----------*-------------*-----------*-------+  :
: | VM                                                                   |  :
: |                                                                      |  :
: | Inside the VM runs:                                                  |  :
: |    - compute_ctl (listens on port 3080)                              |  :
: |    - Postgres (port 5432)                                            |  :
: |    - VM informant (port 10301)                                       |  :
: |    - vector (metrics on port 9100)                                   |  :
: |                                                                      |  :
: +----------------------------------------------------------------------+  :
:                                                                           :
+===========================================================================+

Legend:

    -----> TCP connection. The direction of the arrow indicates who initiates the connection

 +---------+
 |         | Service or process
 +---------+

           |
           *  Open port
           |

#+END_SRC
#+RESULTS:
[[file:ARCHITECTURE-network-diagram.png]]
